import { assert } from 'chai';
import bloomFilter from '../packages/web3-utils/src/bloomFilter.js';

const addressTests = [
    {
        bloom: [
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000',
            '0000000000000000000000000000000000000000000000000000000000000000'
        ],
        address: '0xb794f5ea0ba39494ce839613fffba74279579268',
        result: false
    },
    {
        bloom: [
            '0020008400000010000000000400000200000008000000000010000000002000',
            '0000800000200000000800040000000100000000000000400000000000000000',
            '00000001000200008000000D0000000000100004000004000001000000000000',
            '0140000822000000000000400004080200400020000000000000001000004100',
            '0000020100008000000000000000000000000010000000080000000000800900',
            '000000000000000000000000100000800000000000000C280000000000000100',
            '0000000200004000200000008000000000000000000000002012002000002020',
            '0000000040000000000000040000000400000000000000000000020000000000'
        ],
        address: '0x54D2C22A7E422DFC71D09D1557D4EBA6C9997D12',
        result: true
    },
    {
        bloom: [
            '0020008400000010000000000400000200000008000000000010000000002000',
            '0000800000200000000800040000000100000000000000400000000000000000',
            '00000001000200008000000D0000000000100004000004000001000000000000',
            '0140000822000000000000400004080200400020000000000000001000004100',
            '0000020100008000000000000000000000000010000000080000000000800900',
            '000000000000000000000000100000800000000000000C280000000000000100',
            '0000000200004000200000008000000000000000000000002012002000002020',
            '0000000040000000000000040000000400000000000000000000020000000000'
        ],
        address: '0x54d2c22a7e422dfc71d09d1557d4eba6c9997d13',
        result: false
    }
];

describe('web3-utils/bloomFilter', () => {
    describe('testAddress', () => {
        addressTests.forEach((test) => {
            const bloom = `0x${test.bloom.join('')}`;
            assert.equal(bloomFilter.testAddress(bloom, test.address), test.result);
        });
    });
});
